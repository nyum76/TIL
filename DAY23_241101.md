# 내일배움캠프 23일차 TIL

## AI 모델 활용 5
### API
* 모델 서빙 (Serving) : AI 모델을 실제 어플리케이션에서 사용할 수 있도록 함
  * 외부(입력) -> 예측 수행 -> 결과 반환
* API 
  * **RESTful API** : REST 아키텍처를 따르는 API
    * REST 
      * 표현 : 클라이언트에서 자원요청시 서버가 현재상태를 표현한 자원을 반환함
      * 무상태성 : 클라이언트와 서버의 모든 요청이 독립적. 유지 X (기억 X)
      * 자원 : url로 식별
      * HTTP 메서드
        * GET : 서버에서 데이터 가져옴
        * POST : 서버로 데이터 보냄
        * PUT : 서버의 데이터 업데이트
        * DELETE : 서버의 데이터 삭제
  * **FastAPI** : 파이썬에서 RESTful API 구축시 매우 편한 패키지
    * **'웹 프레임워크'**로, **API** 와 라우팅 기능을 제공
    * 요청처리, 통신 등의 **동작**을 담당하는 곳은 **'서버'** (유비콘 등)

### FastAPI 
* 터미널에서 FastAPI 설치 (사용가상환경 - AI_8) : `pip install fastapi uvicorn`
* API 작성
```py
from fastapi import FastAPI

# app : 간단하게 FastAPI의 인스턴스 생성 가능. FastAPI 핵심요소로 웹어플리케이션 정리와 실행 담당 (예 : 엔드포인트 정리 등)
app = FastAPI()

@app.get("/") # FastAPI 인스턴스를 통해 get 메서드 정리 ( url로 메서드 호출 시 read_root 실행되어 함수가 반환하는게 결과값이 됨 )
def read_root(): 
    return {"message":"hello world"} 
```
* FastAPI 서버 실행 (터미널에서) 
  * **API를 작성한 위치로 이동** 
    * 예시 : **`cd ~/desktop/TIL/STUDY_NOTE/AI_model`**
  * **`uvicorn 5_1:app --reload` 명령어 입력**
    * `5_1` 은 파일명으로, **파일은 .py 파일** 이어야만 하고 **확장자는 입력 X** (.ipynb 파일 안 됨)
    * `--reload` : 코드가 변경될 때 서버를 자동으로 다시 로드 해 주는 옵션
* 실행시 나오는 정보
  * `INFO: Will watch for changes in these directories:[디렉토리]`
    * 서버가 이 디렉토리에서 파일 변경사항을 감지하고 변경이 발생할 경우 자동으로 서버를 재시작
  * `INFO: Uvicorn running on 주소 (Press CTRL+C to quit)`
    * Uvicorn 서버가 해당 주소에서 실행되고 있으며, 이 주소를 통해 애플리케이션에 접근 할 수 있고, 서버를 종료하려면 `CRTL + C` 하라는 의미
  * `INFO: Started reloader process [프로세스ID] using StatReload`
    * 파일 변경 사항을 감지하고 자동으로 재시작하는 reloader process 가 시작됨. 프로세스ID 도 이 코드에서 확인 가능
  * `INFO: Started server process [프로세스ID]`
    * Uvicorn 서버 프로세스가 시작되었음을 의미. 프로세스ID 코드에서 확인
  * `INFO: Waiting for application startup.`
    * FastAPI 애플리케이션이 시작될 준비가 되었음을 의미
  * `INFO: Application startup complete.`
    * FastAPI 애플리케이션이 성공적으로 시작되었음을 의미. 이제 API 요청을 받을 준비 완료된 상태임
### FastAPI 활용
* [위의 내용대로 실행한 모습](#fastapi)
![](/img/241101_FastAPI.png)
* API 내용을 `minmin<3` 으로 수정
![](/img/241101_FastAPI_minmin<3.png)
* API 에서 `root` 를 바꿨지만 `주소의 root` 를 바꾸지 않으면 `"Not Found"`
![](/img/241101_FastAPI_rootnotfound.png)
* 위에서 주소도 바꿔주면 정상적으로 실행되는 모습
![](/img/241101_FastAPI_root_hi.png)
* FastAPI 문서화 기능 활용 (주소 끝에 `/docs`)
![](/img/241101_FastAPI_docs.png)
