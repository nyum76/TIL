# 내일배움캠프 22일차 TIL

## PyTorch
: 딥러닝 프레임워크로, 딥러닝 모델을 쉽게 구축하고 실험 할 수 있게 도와줌
* Transformer 모델
  * 자연어처리(NLP)에서 뛰어난 성능
* [Pytorch 로 Transformer 모델 구현](https://github.com/nyum76/TIL/blob/main/STUDY_NOTE/AI_model/2_3.ipynb)

## 다양한 언어 모델 실습
* 용어
  * 임베딩 : 고차원데이터 -> 저차원데이터 (비정형데이터 -> 수치형데이터)
    * 워드 임베딩 : 자연어처리 단어를 벡터로 표현
    * 센텐스 임베딩 : 문장 전체를 벡터로 표현
    * 이미지 임베딩 : 이미지를 벡터로 표현
    * 그래프 임베딩
  * 유사도 : 두 데이터가 얼마나 비슷한지 수치로 나타냄
    * 코사인 유사도
* [다양한 언어 모델 실습](https://github.com/nyum76/TIL/blob/main/STUDY_NOTE/AI_model/3_1_%EB%8B%A4%EC%96%91%ED%95%9C%EC%96%B8%EC%96%B4%EB%AA%A8%EB%8D%B8%EC%8B%A4%EC%8A%B5.ipynb)
  * *강사님이 자료에 코드를 안 주신 부분이 있어서 제대로 안 된 것도 있음*-> 나중에 하기

## 사전학습과 파인튜닝
* **사전학습 (Pre-training)** : 대규모 데이터셋을 활용해 모델을 처음 부터 학습
  * Bert 의 사전학습
    * MLM : 문장 일부 단어 마스킹해서 마스킹 한 단어 예측 -> 문맥 이해 능력
    * NSP : 문장간 논리적 관계 학습
* **파인튜닝 (Fine-tuning)** : 사전학습된 모델을 **특정 작업** 에 맞게 추가 학습
  * **bert-base-uncased** : 자연어처리. 감정분석
    * 단점 : 대소문자 구분 X, 영어 텍스트에 특화, 최대 토큰(단어) 512 개

## 생성형 AI 란?
: 사용자의 입력에 따라 적절한 콘텐츠 생성하는 AI
* 직접 만드려면 고려할 것
  * 고품질의 대규모 데이터
  * 높은 컴퓨팅 자원 요구
  * 훈련과정의 불안정성
    * 모델 붕괴
    * 균형잡힌 학습
  * 윤리적 문제
  * 클라우드 서비스 활용

## 생성형 모델의 기본원리
* 특징
  * **랜덤성 (Randomness)**
    * 출력 데이터 생성시, **확률 분포**에 따라 다양한 선택지 고려해 때마다 **출력이 조금씩 다름**
  * **조건성 (Conditionality)** 
    * 입력 **조건에 따라** 새 데이터 생성
* 모델 원리
  * 텍스트 기반 모델
    * 1. 입력 토큰화 : 입력 텍스트를 모델이 이해할 수 있게 토큰으로 변환
    * 2. 확률 예측 : 각 단어의 확률 계산
    * 3. 랜덤 선택 : b에서 생성된 단어에서 랜덤하게 다음 단어 선택 (temperature 파라미터로 랜덤성 조정)
    * 4. 반복 생성 : 위의 과정 반복 후 문장이 완성될 때까지 텍스트 생성
  * 이미지 기반 모델
    * 1. 텍스트 인코딩 : 입력된 텍스트 조건 -> 벡터로 인코딩 후 모델에 입력
    * 2. 이미지 생성 : 모델이 인코딩된 텍스트 + 이미지 주요 특징 생성
    * 3. 세부사항 추가 : 랜덤성으로 세부 이미지 요소 생성 후 합성해 최종 이미지 생성
  * 오디오 기반 모델
    * 1. 텍스트 or 멜로디 인코딩 
    * 2. 오디오 생성 : 인코딩된 입력을 바탕으로 오디오 신호 생성
    * 3. 랜덤성 적용 : 음성 미세한 변화 추가

## GPT-4o 와 Stable Diffusion 생성형 모델 실습
[4-3 생성형 모델 실습](https://github.com/nyum76/TIL/blob/main/STUDY_NOTE/AI_model/4_3_generativeAI.ipynb)
* **key** : 특정 서비스 사용을 위한 인증 수단으로, 사용한 만큼 비용이 나오기에 **공개하면 XXX**
  * 실습의 코드에 API 키를 코드 상에 노출하는데 이는 추천 X
  * key 는 설정 파일이나 별도의 환경 변수에 저장
* Stable Diffusion 모델
  * guidance_scale : 텍스트 조건을 얼마나 강하게 반영할지 (확률 조정)
    * 랜덤성을 낮추고, 조건 충실도를 높임
  * num_inference_steps : 이미지 생성 단계에서 어느정도로 추론할지 
    * 이미지 품질을 상세히 결정함
    * 이 부분을 잘 설정하지 않으면 이미지 생성시 구체적인 부분이 뭉개질 수 있음 ( 손가락 6개 등등)
  * 그 외 플러그인들 : 화풍에 대한 플러그인 등
---
## 회고
알게 된 것
* [패키지 만들기](https://github.com/nyum76/TIL/blob/main/_NOTES/pip_freeze.md)
* [마크다운에서 특정 부분으로 이동시키기](https://github.com/nyum76/TIL/blob/main/_NOTES/markdown_tip.md)
* 또한 VSCode 에서 터미널에 따로 git add,commit,push,... 할 필요 없이 commit & push 하는 방법을 알았다
  1. 왼쪽에 Source Control 클릭
  2. Message 를 남긴 후 commit & Push 클릭
    ![](/img/241031_sourcencontrol.png)